PROCEDURE RIM_DAT (TD,LINEA)
PRIVATE COL:=SETCOLOR() , LI := 7
SETCOLOR(INVER)
DO CASE
CASE TD = 1
   @  1,39 SAY CODVAC
   @  4,23 SAY FECNAC
   @  4,34 SAY PADRE
   @  4,41 SAY MADRE
   @  4,52 SAY RC PICTURE'@! XXXXXXX'
   IF ACEPTA()
      DELETE
   ENDIF
CASE TD = 2 .AND. FECPAR>CTOD('  /  /  ') .AND. FECSER=CTOD('  /  /  ') .AND. FECTAC=CTOD('  /  /  ') .AND. FINLAC=CTOD('  /  / ')
   @  7,23 SAY FECPAR
   @  7,34 SAY SEXO
   @  7,45 SAY TIPPAR
   @  7,50 SAY NROPAR PICTURE '99'
   @  7,55 SAY DIALAC PICTURE'999'
   @  7,61 SAY ANTSEC PICTURE'999'
   @  7,67 SAY ULTPRO PICTURE'999'
   @  7,72 SAY ACUPRO PICTURE'99999'
   IF NROSER > 0
      SELECT SERVIC
      REPLACE FECPAR WITH TAMBO->FECPAR FOR CODVAC=COD
   ENDIF
   IF ACEPTA()
      IF SEXO # 'M'
         R=RECNO()
         H=SEXO
         SEEK H
         IF FOUND()
            DELETE
         ENDIF
      GO R
      ENDIF
      REPLACE FECPAR WITH CTOD('  /  /  '), SEXO WITH SPACE(4),TIPPAR WITH SPACE(1)
      REPLACE NROPAR WITH NROPAR - 1 , DIALAC WITH 0
   ENDIF
CASE TD = 3 .AND. FECSER>CTOD('  /  /  ')  .AND. FECTAC=CTOD('  /  /  ')
   TO = TORO
   @ LINEA,23 SAY FECSER
   @ LINEA,34 SAY TORO
   @ LINEA,40 SAY INSEMI
   @ LINEA,46 SAY NROSER PICTURE '99'
   IF ACEPTA()
      SELECT TOROS
      IF TORO # TO
         LOCATE FOR TORO = TO
         REPLACE DSAIFI WITH DSAIFI+1, DTOTAL WITH DTOTAL+1
      ENDIF
      SELECT SERVIC
      LOCATE FOR CODVAC=COD .AND. NROSER=TAMBO->NROSER
      IF FOUND()
         DELETE
      ENDIF
      PRIVATE FS:=CTOD('') , TS:=SPACE(4), IN:=SPACE(4), NS:=0
      IF NROSER>1
         SELECT SERVIC
         LOCATE FOR CODVAC=COD .AND. NROSER=TAMBO->NROSER-1
         IF FOUND()
            FS=FECSER
            TS=TORO
            IN=INSEMI
            NS=NROSER
         ENDIF
      ENDIF
      SELECT TAMBO
      REPLACE FECSER WITH FS, TORO WITH TS, INSEMI WITH IN, NROSER WITH NS
      COMMIT
      ***   INTERVALO PARTO 1er SERVICIO   ***
      IF NS=1 .AND. (FECSER-FECPAR) < 1000
         REPLACE PARSER WITH (FECSER-FECPAR)
      ELSEIF NS=0
         REPLACE PARSER WITH 0
      ENDIF
      *
   ENDIF
CASE TD = 4 .AND. FECTAC>CTOD('  /  /  ')
   @  LINEA,23 SAY FECTAC
   @  LINEA,34 SAY RESULT
   IF ACEPTA()
      SELECT SERVIC
      SEEK COD+DTOS(TAMBO->FECSER)
      IF FOUND()
         REPLACE RESULT WITH SPACE(1)
      ENDIF
      SELECT TAMBO
      ***   PARTO PRENIEZ   ***
      REPLACE PARPRE WITH 0
      ***   DIAS GEST.   ***
      REPLACE DIAGES WITH 0

      REPLACE FECTAC WITH CTOD('') , RESULT WITH SPACE(1)
   ENDIF
CASE TD = 5 .AND. FINLAC>CTOD('  /  /  ')
   @  LINEA,23 SAY FINLAC
   @  LINEA ,51 SAY DIASEC PICTURE'999'
   @  LINEA ,57 SAY ANTLAC PICTURE'999'
   IF ACEPTA()
      REPLACE FINLAC WITH CTOD(""), DIASEC WITH 0 ,DIALAC WITH VAL( STR(DIA-FECPAR,3) )
   ENDIF
CASE TD = 6 .AND. MARENF
   SELECT ENFERM
   SEEK COD
   X = 0
   DO WHILE CODVAC = COD
      X=X+1
      SKIP
   ENDDO
   SKIP - 1
   @ LINEA  ,23 SAY FECHA
   @ LINEA  ,34 SAY DIAPAR PICTURE'999'
   @ LINEA  ,38 SAY DIAACU PICTURE'999'
   IF ACEPTA()
      DELETE
      SELECT TAMBO
      IF X = 1
         REPLACE MARENF WITH .F.
      ENDIF
   ENDIF
CASE TD = 7
   @ LINEA,48 SAY REFILA
   @ LINEA,53 SAY CODRFL
   IF ACEPTA()
      REPLACE REFILA WITH SPACE(1) , CODRFL WITH SPACE(4)
   ENDIF
CASE TD = 8
   REPLACE ACUPRO WITH ACUPRO-(ULTPRO*30)
   TO1 = ULTPRO/2
   SETCOLOR(INVER)
   @ LINEA,63 SAY TO1 PICTURE "999"
   SETCOLOR(COMUN)
   IF ACEPTA()
      REPLACE ACUPRO WITH ACUPRO+(ULTPRO*30), ULTPRO WITH 0
   ENDIF
ENDCASE
SETCOLOR(COL)
