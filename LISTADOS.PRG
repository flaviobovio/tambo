PROCEDURE LISTADOS()
CLS
PRIVATE VA , ENC , PK , LI , RFI
@  0, 0 TO 23,79 DOUBLE
@  0, 2 SAY " SELECCIONE TIPO DE LISTADO A IMPRIMIR "
@  2,17 PROMPT "GENERAL                                  " MESSAGE 'TODAS LAS VACAS'
@  3,17 PROMPT "VACAS POR CODIGO                         " MESSAGE 'VACAS SELECCIONADAS POR CODIGO'
@  4,17 PROMPT "VACAS CON RECHAZO FIN DE LACTANCIA       " MESSAGE 'TODAS LAS VACAS CON R.F.L.'
@  5,17 PROMPT "ENTRE x Y x DIAS DE PARIDAS              " MESSAGE 'PARIDAS ENTRE UN LAPSO DE DIAS'
@  6,17 PROMPT "SIN SERVICIO CON MAS DE x DIAS DE PARIDAS" MESSAGE 'SIN SERVICIO CON MAS x DIAS DE PARIDAS'
@  7,17 PROMPT "CON x A x SERV.NO RETENIDOS DE x DIAS    " MESSAGE 'CON CIERTA CANTIDAD DE SERVICIOS NO RETENIDOS DE TANTOS DIAS'
@  8,17 PROMPT "CON x O MAS SERVICIOS                    " MESSAGE 'CON UNA CANTIDAD O MAS DE SERVICIOS'
@  9,17 PROMPT "PRE벤Z                                   " MESSAGE 'VACAS CON SERVICIO EL MES xx'
@ 10,17 PROMPT "SECAS                                    " MESSAGE 'SECAS'
@ 11,17 PROMPT "VACAS A SECAR                            " MESSAGE 'A SECAR POR PRE벤Z '
@ 12,17 prompt "CON 4 O MAS SERVICIOS Y VACIAS           " MESSAGE 'CON 4 O MAS SERVICIOS Y QUE ESTAN VACIAS'
@ 13,17 prompt "CON 90 O MAS DIAS DEL ULT.SERV.Y VACIAS  " MESSAGE 'CON 90 O MAS DIAS DEL ULTIMO SERVICIO QUE ESTAN VACIAS'
@ 14,17 PROMPT 'PRODUCCION                               ' MESSAGE 'PRODUCCION'
@ 15,17 PROMPT 'RODEOS                                   ' MESSAGE 'RODEOS'
@ 16,17 PROMPT "VACAS ENFERMAS                           " MESSAGE 'VACAS QUE ESTAN EN ENFERMERIA'
@ 17,17 PROMPT "VACAS QUE PASARON POR ENFERMERIA         " MESSAGE 'VACAS QUE PASARON POR ENFERMERIA'
@ 18,17 PROMPT "SERVICIOS DEL MES xx                     " MESSAGE 'TODOS LOS SERVICIOS DADOS EN EL MES xx'
@ 19,17 PROMPT "VACAS CON F.PARTO/FPA ENTRE DOS FECHAS   " MESSAGE ""
@ 20,17 PROMPT "LISTADO DE PRODUCCION POR FECHA DE PARTO " MESSAGE ""
@ 21,17 PROMPT "CONDICIONADOS POR EL USUARIO             " MESSAGE 'CON DIFERENTES TIPOS DE CONDICIONES'

MENU TO LI
@24, 0 CLEAR
SELECT TAMBO
SET CURSOR ON
DO CASE
   CASE LI = 1
      COUNT TO VA
      ENC='LISTADO GENERAL DE '+ALLTRIM( STR( VA ))+' VACA/S'
   CASE LI = 2
      VA = LIS_IDE()
      ENC='LISTADO DE '+ ALLTRIM( STR(VA) )+' VACA/S'
   CASE LI = 3
      SET FILTER TO REFILA = "R"
      COUNT FOR REFILA = "R" TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS CON RECHAZO FIN DE LACTANCIA '
   CASE LI = 4
      PRIVATE P1 := 30 , P2 := 45
      @19,24 TO 21,55
      @20,26 SAY 'PARIDAS ENTRE     Y     DIAS'
      @20,40 GET P1 PICTURE'999' VALID P1>0
      @20,46 GET P2 PICTURE'999' VALID P2>0
      READ
      SET FILTER TO (DIA-FECPAR)>=P1 .AND. (DIA-FECPAR)<=P2
      COUNT FOR (DIA-FECPAR)>=P1 .AND. (DIA-FECPAR)<=P2 TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS PARIDAS ENTRE '+STR(P1,3)+' Y '+STR(P2,3)+' DIAS'
   CASE LI = 5
      PRIVATE SS := 90
      @19,16 TO 21,62
      @20,18 SAY 'SIN SERVICIO CON MAS DE     DIAS DE PARIDAS'
      @20,42 GET SS PICTURE '999' VALID SS>0
      READ
      SET FILTER TO DIA-FECPAR >= SS .AND. FECSER < FECPAR
      COUNT FOR DIA-FECPAR >= SS .AND. FECSER < FECPAR TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS SIN SERVICIO CON MAS DE '+STR(SS,3)+' DIAS DE PARIDAS'
   CASE LI = 6
      PRIVATE S1:=0 , S2:=0 , DI:=0
      @19,12 TO 21,69
      @20,14 SAY 'CON     A     SERVICIO/S NO RETENIDO/S      O MAS DIAS'
      @20,18 GET S1 PICTURE '999' VALID S1>0
      @20,24 GET S2 PICTURE '999'
      @20,53 GET DI PICTURE '999' VALID DI>0
      READ
      IF S2=0
         S2=100
      ENDIF
      SET FILTER TO NROSER>=S1 .AND. NROSER<=S2 .AND. DIA-FECSER>60 .AND. RESULT='V'
      COUNT FOR NROSER>=S1 .AND. NROSER<=S2 .AND. DIA-FECSER>60 .AND. RESULT='V' TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS CON '+STR(S1,3)+' A '+STR(S2,3)+' SERVICIO/S NO RETENIDOS DE '+STR(DI,3)+' DIAS O MAS'
   CASE LI = 7
      PRIVATE NS := 4
      @19,25 TO 21,59
      @20,27 SAY 'INGRESE NUMERO DE SERVICIOS:' GET NS PICTURE '99' VALID NS>0
      READ
      SET FILTER TO NROSER >= NS
      COUNT FOR NROSER >= NS TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS CON '+STR(NS,2)+' O MAS SERVICIOS'
   CASE LI = 8
      PRIVATE ME := 0 , AN:= VAL (RIGHT( STR( YEAR(DIA) ),2) )
      @19,25 CLEAR TO 21,57
      @19,25 TO 21,57
      @20,27 SAY 'INGRESE NUMERO DE MES:' GET ME PICTURE '99/' VALID (ME>=1 .AND. ME<=12)
      @20,53 GET AN PICTURE "99"
      READ
      SET FILTER TO MONTH(FECSER)=ME .AND. VAL(RIGHT(STR(YEAR(FECSER)),2))=AN .AND. NROPAR>0
      COUNT FOR MONTH(FECSER)=ME .AND. VAL(RIGHT(STR(YEAR(FECSER)),2))=AN .AND. NROPAR>0 TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS CON SERVICIO EN '+MES(ME)
   CASE LI = 9
      SET FILTER TO DIASEC > 0
      COUNT FOR DIASEC > 0 TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS SECAS'
   CASE LI = 10
      @19,25 clear TO 21,56
      @19,25 TO 21,56
      @20,27 PROMPT '1ra QUINCENA'
      @20,42 PROMPT '2da QUINCENA'
      MENU TO Q
      IF Q=1
         Q =CTOD(STUFF(DTOC(DIA),1,2,'15'))
         PE=230
         QU='PRIMERA QUINCENA'
      ELSE
         Q  = ULT_DIA( DIA )
         PE = 200 + VAL(SUBSTR(DTOC(  ULT_DIA( ULT_DIA ( DIA ) - 230 ) ),1,2))
         QU='SEGUNDA QUINCENA'
      ENDIF
      SET FILTER TO (Q-FECSER) >= 216 .AND. (Q-FECSER) <= PE .AND. RESULT='P' .AND. FINLAC=CTOD('  /  /  ') .AND. NROPAR>0
      COUNT   FOR   (Q-FECSER) >= 216 .AND. (Q-FECSER) <= PE .AND. RESULT='P' .AND. FINLAC=CTOD('  /  /  ') .AND. NROPAR>0 TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS A SECAR POR PRE벤Z DE LA '+QU
   CASE LI = 11
      SET FILTER TO NROSER>=4 .AND. RESULT#'P'
      COUNT FOR NROSER>=4 .AND. RESULT#'P' TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS CON MAS DE 4 SERVICIOS QUE NO ESTAN PRE베DAS'
   CASE LI = 12
      SET FILTER TO DIAGES >= 90 .AND. RESULT#'P'
      COUNT FOR DIAGES >= 90 .AND. RESULT#'P' TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACAS CON MAS DE 90 DIAS DEL ULTIMO SERVICIO Y NO PRE베DAS'
   CASE LI = 13

      SELECT PRODUC
      @17,25 clear TO 21,56
      @17,25 TO 21,56
      priv me:=month(config->produc), an:=year(config->produc)
      @ 18,27 say "Control Lechero del: "
      @ 18,48 get me pict "99" rang 1,12
      @ 18,51 get an pict "9999"
      read
      set filt to month(contro) = me .and. year(contro) = an
      GO TOP
      VA=0
      PK=0
      DO WHILE !EOF()
         VA++
         PK=PK+TOTAL
         SKIP
      ENDDO
      @20,27 PROMPT '1-POR CODIGO'
      @20,42 PROMPT '2-POR LITROS'
      MENU TO Q
      IF Q = 1
         SET ORDER TO 1
      ELSE
         SET ORDER TO 2
      ENDIF
      ENC='LISTADO DE PRODUCCION DEL '+ALLTRIM(str(me,2)+"/"+str(an,4))+", "+ALLTRIM(STR(VA))+' VACAS, '+;
      ALLTRIM(STR(PK))+' Lts / '+ALLTRIM(STR(VA))+' VACAS = '+ALLTRIM(STR(ROUND (PK/VA,0)))








IF .f.
****            borrar si no sirve



      SELECT tambo
      SET ORDER TO 1
      SELECT PRODUC
      SET RELATION TO codvac INTO tambo
      GO TOP
      VA=0
      PK=0
      DO WHILE !EOF()
         VA++
         PK=PK+TOTAL
         SKIP
      ENDDO
      ENC='LISTADO DE PRODUCCION DE '+ALLTRIM(STR(VA))+' VACAS, '+ALLTRIM(STR(PK))+' Lts / '+ALLTRIM(STR(VA))+' VACAS = '+;
      ALLTRIM(STR(ROUND (PK/VA,0)))
      @19,25 clear TO 21,56
      @19,25 TO 21,56
      @20,27 PROMPT '1-POR CODIGO'
      @20,42 PROMPT '2-POR LITROS'
      MENU TO Q
      IF Q = 1
         SET ORDER TO 1
      ELSE
         SET ORDER TO 2
      ENDIF
ENDIF




   CASE LI = 14
      LIS_ROD ()
   CASE LI = 15
      SELECT ENFERM
      VA = CONTADO(1)
      SET FILTER TO MARCA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACA/S, DE ENFERMERIA'
   CASE LI = 16
      SELECT ENFERM
      VA = CONTADO(2)
      SET FILTER TO !MARCA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' VACA/S, QUE PASARON POR ENFERMERIA'
   CASE LI = 17
      PRIVATE ME := 0 , AN:= VAL (RIGHT( STR( YEAR(DIA) ),2) )
      @19,25 CLEAR TO 21,57
      @19,25 TO 21,57
      @20,27 SAY 'INGRESE NUMERO DE MES:' GET ME PICTURE '99/' VALID (ME>=1 .AND. ME<=12)
      @20,53 GET AN PICTURE "99"
      READ
      SELECT SERVIC
      SET FILTER TO MONTH(FECSER)=ME .AND. VAL(RIGHT(STR(YEAR(FECSER)),2))=AN
      COUNT FOR MONTH(FECSER)=ME .AND. VAL(RIGHT(STR(YEAR(FECSER)),2))=AN TO VA
      ENC='LISTADO DE '+ALLTRIM(STR(VA))+' SERVICIOS EN '+MES(ME)





   CASE LI = 18
      priv fe1:= fe2 := ctod("")
      @15,18 clea to 17,45
      @15,18 to 17,45
      @16,20 say "Entre:" get fe1
      @16,36 get fe2 vali fe2 >= fe1
      read
      set filt to (fecpar>=fe1 .and. fecpar<=fe2) .or. (fpapro>=fe1 .and. fpapro<=fe2)
      count to va
      enc = "LISTADO DE VACAS CON F.PARTO / F.PARTO APROX. ENTRE EL "+DTOC(FE1)+" Y EL "+DTOC(FE2)
   CASE LI = 19
      p_anual ()
      RETU
   CASE LI = 20
      VA=FIL_LIS()
      ENC='LISTADO DE '+ ALLTRIM( STR(VA) )+' VACAS CON '+ENC
   OTHERWISE
      RETURN
ENDCASE
SET CURSOR OFF
CLS
IF VA > 0
   VER_LIS(ENC)
ELSE
   SETCOLOR(INVER)
   @24, 6 SAY ' NO HAY NINGUNA VACA PARA LISTAR. CUALQUIER TECLA PARA CONTINUAR... '
   SETCOLOR(COMUN)
   INKEY(0)
ENDIF
SET RELATION TO
SET FILTER TO
SELECT PRODUC
SET ORDER TO 1
SELECT TAMBO
SET ORDER TO 1
# INCLUDE 'ULT_DIA.PRG'
# INCLUDE 'LIS_ROD.PRG'
# INCLUDE 'FIL_LIS.PRG'
# INCLUDE 'LIS_IDE.PRG'
# INCLUDE 'CONTADO.PRG'
# INCLUDE 'VER_LIS.PRG'
# INCLUDE 'REP_GEN.PRG'
# INCLUDE 'REP_ENF.PRG'
# INCLUDE 'REP_SER.PRG'
# INCLUDE 'REP_PRO.PRG'
# INCLUDE 'REP_PAN.PRG'
# include "p_anual.prg"

