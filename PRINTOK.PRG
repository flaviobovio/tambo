FUNCTION PRINTOK()
DO WHILE .T.
  IF ISPRINTER()
    RETURN .T.
  ELSE
    TONE (200,2)
    SETCURSOR(0)
    SETCOLOR(COMUN)
    PRIVATE PANTALLA := SAVESCREEN( 0, 0,24,79), X :=0, S_C := SETCURSOR(), COL:=SETCOLOR()
    @11,15 CLEAR TO 14,62
    @ 9,13,16,64 BOX 'Û'
    @10,14,15,63 BOX 'Û'
    @12,17 SAY'  LA IMPRESORA NO ESTA LISTA PARA IMPRIMIR  '
    @13,17 SAY'<Enter> REINTENTAR   <Esc> ABORTAR IMPRESION'
    DO WHILE X#13 .AND. X#27
        X=INKEY()
    ENDDO
    RESTSCREEN( 0, 0,24,79,PANTALLA )
    SETCOLOR (COL)
    SETCURSOR (S_C)
    IF X=13
        X=0
        LOOP
    ELSE
        @11,15 CLEAR TO 14,62
        @ 9,13,16,64 BOX 'Û'
        @10,14,15,63 BOX 'Û'
        @12,23 SAY' LA IMPRESION HA SIDO ABORTADA   '
        @13,23 SAY'CUALQUIER TECLA PARA CONTINUAR...'
        INKEY(0)
        RESTSCREEN( 0, 0,24,79,PANTALLA )
        SETCOLOR (COL)
        SETCURSOR (S_C)
        RETURN .F.
    ENDIF
  ENDIF
ENDDO